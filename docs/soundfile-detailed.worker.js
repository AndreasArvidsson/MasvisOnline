!function(t){var e={};function r(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);var a={legendformatterTime:function(t,e){return a.round(e/t,5)},tickerLabelformatterTime:function(t,e){return a.round(e/t,3)},tickerValuePreFormatter:function(t,e){return e/t},tickerValuePostFormatter:function(t,e){return e*t},tickerAmplitude:function(t,e,r){function n(t){return a.round(t,2)}var o=r-e;return[{value:e,label:n(e)},{value:e+.25*o,label:n(e+.25*o)},{value:e+.5*o,label:n(e+.5*o)},{value:e+.75*o,label:n(e+.75*o)},{value:r,label:n(r)}]},toDb:function(t,e){return e?a.round(20*o(t),e):20*o(t)},round:function(t,e){var r=Math.pow(10,e);return Math.round(t*r)/r},getColor:function(t){return t>=u.length?"#000000":u[t]},getName:function(t){return t>=i.length?"Ch"+t:i[t]},getShortName:function(t){return l>=l.length?"Ch"+t:l[t]},getTitle:function(t){return{label:t,align:"left",size:17,padding:0}},getBorder:function(){return{width:"1px"}}},n=a,o=function(t){return Math.log(t)/Math.LN10},u=["#000000","#0000FF","#FF0000","#800080","#00FF00","#8080FF","#FF8080","#FF00FF","#00FFFF"],i=["Time(S)","Left","Right","Center","LFE","Surr left","Surr right","Surr back left","Surr back right"],l=["S","L","R","C","LFE","SL","SR","SBL","SBR"],c={};function s(t,e){if(!(this instanceof s))return new s(t);var r=Math.floor(Math.log(t)/Math.LN2);if(Math.pow(2,r)===t){this._bufferSize=t,this._bandwidth=s.calculateBandwidth(t,e);for(var a=new Float32Array(t/2),n=new Float32Array(t/2),o=0;o<t/2;o++)a[o]=Math.cos(2*Math.PI*o/t),n[o]=Math.sin(2*Math.PI*o/t);this._cosTable=a,this._sinTable=n,this._real=new Float32Array(t),this._imag=new Float32Array(t);for(var u,i=new Uint32Array(t),l=1,c=t>>1;l<t;){for(u=0;u<l;u++)i[u+l]=i[u]+c;l<<=1,c>>=1}this._reverseTable=i}else console.error("Invalid buffer size, must be a power of 2.")}function f(t,e){if(this._func=t,e){var r=new Float32Array(e);this._data=r;for(var a=0;a<e;++a)r[a]=this._func(e,a);this.process=function(t,e){var a=t.length;if(e)for(var n=0;n<a;++n)e[n]=t[n]*r[n];else for(var o=0;o<a;++o)t[o]*=r[o]}}else this.process=function(e,r){var a=e.length;if(r)for(var n=0;n<a;++n)r[n]=e[n]*t(a,n);else for(var o=0;o<a;++o)e[o]*=t(a,o)}}s.prototype.fft=function(t){if(t.length===this._bufferSize){for(var e=this._bufferSize,r=this._cosTable,a=this._sinTable,n=this._reverseTable,o=this._real,u=this._imag,i=0;i<e;++i)o[i]=t[n[i]],u[i]=0;for(var l=2;l<=e;l*=2)for(var c=l/2,s=e/l,f=0;f<e;f+=l)for(var h=f,p=0;h<f+c;++h,p+=s){var m=o[h+c]*r[p]+u[h+c]*a[p],g=-o[h+c]*a[p]+u[h+c]*r[p];o[h+c]=o[h]-m,u[h+c]=u[h]-g,o[h]+=m,u[h]+=g}}else console.error("Given buffer has size other than expected. Expected: "+this._bufferSize+" found: "+t.length)},s.prototype.getReal=function(){return this._real},s.prototype.getImaginary=function(){return this._imag},s.prototype.getBandFrequency=function(t){return this._bandwidth*t+this._bandwidth/2},s.prototype.calculateSpectrum=function(t){var e=this._bufferSize/2;t||(t=new Float32Array(e));for(var r=1/this._bufferSize,a=this._real,n=this._imag,o=Math.sqrt,u=0;u<e;++u)t[u]=r*o(a[u]*a[u]+n[u]*n[u]);return t},s.prototype.calculateSpectrumDb=function(t){var e=this._bufferSize/2;t||(t=new Float32Array(e));for(var r,a=1/this._bufferSize,n=this._real,o=this._imag,u=Math.sqrt,i=0;i<e;++i)t[i]=20*(r=a*u(n[i]*n[i]+o[i]*o[i]),Math.log(r)/Math.LN10);return t},s.calculatePow2Size=function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.log(2)))},s.calculateBandwidth=function(t,e){return 2/t*e/2},s.binIndexToFreq=function(t,e){return e*t+e/2},s.freqToBinIndex=function(t,e){return(t-e/2)/e},c.FFT=s,f.prototype.getData=function(){return this._data};var h=2*Math.PI,p={Bartlett:function(t){return new f((function(t,e){return 2/(t-1)*((t-1)/2-Math.abs(e-(t-1)/2))}),t)},BartlettHann:function(t){return new f((function(t,e){return.62-.48*Math.abs(e/(t-1)-.5)-.38*Math.cos(h*e/(t-1))}),t)},Blackman:function(t,e){var r=(1-(e=e||.16))/2,a=e/2;return new f((function(t,e){return r-.5*Math.cos(h*e/(t-1))+a*Math.cos(4*Math.PI*e/(t-1))}),t)},Cosine:function(t){return new f((function(t,e){return Math.cos(Math.PI*e/(t-1)-Math.PI/2)}),t)},Gauss:function(t,e){e=e||.25;return new f((function(t,r){return Math.pow(Math.E,-.5*Math.pow((r-(t-1)/2)/(e*(t-1)/2),2))}),t)},Hamming:function(t){return new f((function(t,e){return.54-.46*Math.cos(h*e/(t-1))}),t)},Hann:function(t){return new f((function(t,e){return.5*(1-Math.cos(h*e/(t-1)))}),t)},Lanczos:function(t){return new f((function(t,e){var r=2*e/(t-1)-1;return Math.sin(Math.PI*r)/(Math.PI*r)}),t)},Rectangular:function(){return new f((function(){return 1}),length)},Triangular:function(t){return new f((function(t,e){return 2/t*(t/2-Math.abs(e-(t-1)/2))}),t)}};c.windowFunctions=p,c.biquad=function(t,e,r,a,n,o){var u=0,i=0;this.processBuffer=function(a,l){l||(l=a);for(var c=0;c<a.length;++c){var s=a[c]*t+u;u=a[c]*e-s*n+i,i=a[c]*r-s*o,l[c]=s}},this.processSample=function(a){var l=a*t+u;return u=a*e-l*n+i,i=a*r-l*o,l}},c.allpass=function(t,e){t>e/2.0001&&(t=e/2.0001);var r=Math.tan(Math.PI*t/e),a=(1-r)/(1+r),n=a,o=-a;return new c.biquad(n,-1,0,1,o,0)};var m=c;onmessage=function(t){var e=t.data,r={channels:e.channels};!function(t,e){console.time("calculateLoudestPart");for(var r,a,n=.95*t.peak,o=.02*t.sampleRate,u=0,i=0;i<e.channels.length;++i){for(var l=e.channels[i].graph,c=0,s=0,f=0,h=-1,p=0,m=Math.min(o,l.length)-1;h<m;)Math.abs(l[++h])>n&&++p;for(c=f,s=p,m=l.length-1;h<m;)Math.abs(l[f++])>n&&--p,Math.abs(l[++h])>n&&++p,p>s&&(s=p,c=f);s>u&&(u=s,a=c,r=i)}e.channels[r].loudestPart={count:u,index:a+o/2},console.timeEnd("calculateLoudestPart")}(e,r),function(t,e){console.time("calculateAvgSpectrum");var r=m.FFT.calculatePow2Size(t.sampleRate),a=r/2,o=m.windowFunctions.Blackman(t.sampleRate).getData(),u=new m.FFT(r,t.sampleRate),i=new Float32Array(r);e.channels.forEach((function(e){for(var l=e.graph,c=new Float32Array(a),s=l.length,f=0;f<s;){for(var h=Math.min(f+t.sampleRate,s),p=0;f<h;++f,++p)i[p]=l[f]*o[p];for(;p<r;++p)i[p]=0;u.fft(i);for(var m=u.getReal(),g=u.getImaginary(),v=0;v<a;++v)c[v]+=m[v]*m[v]+g[v]*g[v]}for(var M=e.rms,b=t.sampleRate*s,d=0;d<a;++d)c[d]=n.toDb(Math.sqrt(c[d]/b)/M);e.avgSpectrum=c})),console.timeEnd("calculateAvgSpectrum")}(e,r),function(t,e){console.time("calculateAllpass");var r=[20,60,200,600,2e3,6e3,2e4],a=0;e.channels.forEach((function(e){e.allpass=[],r.forEach((function(r){for(var n=e.graph,o=new m.allpass(r,t.sampleRate),u=0,i=0,l=0,c=0;c<n.length;++c){var s=o.processSample(n[c]);u+=s*s,s>i?i=s:s<l&&(l=s)}var f=Math.max(i,Math.abs(l))/Math.sqrt(u/t.numSamples);a=Math.max(a,f),e.allpass.push(f)}))})),e.allpass={freqs:r,maxCrest:a},console.timeEnd("calculateAllpass")}(e,r),function(t){console.time("calculateHistogram");var e=Math.pow(2,t.bitDepth-1)-1;t.channels.forEach((function(r){for(var a=new Float32Array(Math.pow(2,t.bitDepth)),n=r.graph,o=0;o<n.length;++o)++a[Math.round((n[o]+1)*e)];for(var u={},i=0,l=0,c=0;c<a.length;++c)a[c]&&!u[c]&&(u[c]=!0,++l,i=Math.max(i,a[c]));r.histogram={graph:a,bits:Math.log2(l),peak:i}})),console.timeEnd("calculateHistogram")}(e),function(t,e){console.time("calculatePeakVsRms");var r=0,a=Math.pow(2,t.bitDepth-1)-1,o=-(Math.pow(2,t.bitDepth-1)-1);e.channels.forEach((function(e){for(var u=e.graph,i=Math.ceil(t.numSamples/t.sampleRate),l=new Float32Array(i),c=new Float32Array(i),s=new Float32Array(i),f=u.length,h=0,p=0;p<f;++h){for(var m=Math.min(t.sampleRate,f-p),g=p+m,v=0,M=0,b=0;p<g;++p){var d=u[p];v+=d*d,d<0?(r+=Math.pow(Math.ceil(d*o),2),d<b&&(b=d)):(r+=Math.pow(Math.ceil(d*a),2),d>M&&(M=d))}var w=Math.max(M,Math.abs(b)),F=Math.sqrt(v/m);l[h]=n.toDb(F),c[h]=n.toDb(w),s[h]=n.toDb(w/F)}e.peakVsRms={peak:c,rms:l,crest:s}})),e.checksum=r,console.timeEnd("calculatePeakVsRms")}(e,r);var a=[];r.channels.forEach((function(t){a.push(t.graph.buffer),a.push(t.avgSpectrum.buffer),a.push(t.histogram.graph.buffer),a.push(t.peakVsRms.peak.buffer),a.push(t.peakVsRms.rms.buffer),a.push(t.peakVsRms.crest.buffer)})),postMessage(r,a)}}]);